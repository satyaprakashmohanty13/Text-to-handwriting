<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Text2Pen</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 700px;
      margin: auto;
      padding: 20px;
    }
    textarea {
      width: 100%;
      height: 150px;
    }
    label {
      margin-top: 10px;
      display: block;
    }
    input, select {
      width: 100%;
    }
    button {
      margin-top: 20px;
      padding: 10px 15px;
    }
  </style>
</head>
<body>
  <h1>‚úçÔ∏è Text2Pen</h1>
  <p>Convert your typed text into realistic handwriting.</p>

  <form id="form">
    <label>Enter Text</label>
    <textarea name="textinput">Hello, this is a handwriting test!</textarea>

    <label>Font</label>
    <select name="font_choice">
      <option value="Julian Hand">Julian Hand</option>
      <option value="Kevin Flower">Kevin Flower</option>
    </select>

    <label>Font Size</label>
    <input type="number" name="fontsize" value="72" min="24" max="120" />

    <label>Line Spacing</label>
    <input type="number" name="linespacing" value="10" />

    <label>Margin</label>
    <input type="number" name="margin" value="70" />

    <label>Jitter</label>
    <input type="number" name="jitter" value="0" />

    <label>Columns</label>
    <select name="columns">
      <option value="1">1</option>
      <option value="2">2</option>
      <option value="3">3</option>
    </select>

    <label>Font Color</label>
    <input type="color" name="color" value="#000000" />

    <label>
      <input type="checkbox" name="preview_first" checked />
      Preview Only First Page
    </label>

    <button type="submit">Generate PDF</button>
  </form>

  <p id="status"></p>
  <a id="download-link" href="#" download="handwriting.pdf" style="display:none;">üìÑ Download PDF</a>

  <script>
    const form = document.getElementById("form");
    const status = document.getElementById("status");
    const downloadLink = document.getElementById("download-link");

    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      status.textContent = "Generating...";
      downloadLink.style.display = "none";

      const formData = new FormData(form);
      const data = [
        null, // textfile (we're not uploading one)
        formData.get("textinput"),
        formData.get("font_choice"),
        null, // fontfile
        Number(formData.get("fontsize")),
        Number(formData.get("linespacing")),
        Number(formData.get("margin")),
        Number(formData.get("jitter")),
        formData.get("columns"),
        "Blank (White)", // bg_choice
        null, // bgfile
        formData.get("color"),
        formData.get("preview_first") === "on"
      ];

      const res = await fetch("https://satyaprakashmohanty13-Text2Pen.hf.space/api/predict", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ data })
      });

      if (!res.ok) {
        status.textContent = "Error generating handwriting.";
        return;
      }

      const result = await res.json();
      const fileUrl = result.data[0];
      if (fileUrl) {
        downloadLink.href = fileUrl;
        downloadLink.style.display = "inline";
        status.textContent = "Success! Download your PDF:";
      } else {
        status.textContent = "PDF not generated.";
      }
    });
  </script>
</body>
</html>
